<div class="card p-3">
    <div class="">
        
        <div class="p-0">
			<div class="d-flex justify-content-between flex-wrap">
				<div class="mb-3">
					<h4 >MIS CITAS</h4>
				</div>
				<div class="mb-3">
					
                    <div>
                        <button (click)="showSeleccionarDoctorCita()" type="button" class="btn btn-primary btn-sm">Nueva Cita</button>
                    </div>
				</div>
			</div>
		</div>
        <!--  (change)="changeSearch($event)" ionInput="changeSearch($event)" (change)="segmentChanged($event)"-->

        <!-- <div>
                            <div class="d-flex flex-row">
                                <div class="pr-2">
                                    <label>Estado de cita</label>
                                    <select class="form-control" [(ngModel)]="cita_search.eq.estatus">
                                        <option value="">Todas</option>
                                        <option value="ACTIVA">Activa</option>
                                        <option value="CANCELADA">Canceladas</option>
                                    </select>
                                </div>

                                <div class="pr-2">
                                    <label>
                                        Confirmado:
                                    </label>
                                    <div>

                                        <input type="checkbox" value="SI"
                                            [checked]="cita_search.eq.confirmado_por_doctor=='SI'"
                                            (change)="cita_search.eq.confirmado_por_doctor = cita_search.eq.confirmado_por_doctor=='SI' ? '' : 'SI'">
                                        Por doctor
                                    </div>

                                    <div>
                                        <input type="checkbox" value="SI"
                                            [checked]="cita_search.eq.confirmado_por_paciente=='SI'"
                                            (change)="cita_search.eq.confirmado_por_paciente = cita_search.eq.confirmado_por_paciente=='SI' ? '' : 'SI'">
                                        Por paciente
                                    </div>
                                </div>

                                <div class="pr-2">
                                    <label>Clinica</label>
                                    <select class="form-control" [(ngModel)]="cita_search.eq.id_centro_medico">
                                        <option value="">Todas</option>
                                        <option *ngFor="let centro of centros_medicos" [value]="centro.id">
                                            {{centro.nombre}}</option>
                                    </select>
                                </div>
                                <div class="pr-2">
                                    <label>Fecha Inicio</label> <input class="form-control" type="date"
                                        (change)="dateInicioChange($event.target.value)"
                                        [value]="cita_search.ge.inicio">
                                </div>
                                <div class="pr-2">
                                    <label>Fecha Fin</label><input type="date" class="form-control"
                                        (change)="dateFinChange($event.target.value)" [value]="cita_search.le.inicio">
                                </div>
                                <div class="d-flex align-self-end justify-content-center p-2">
                                    <button type="button" class="btn btn-primary" (click)="buscar()">Buscar</button>
                                </div>
                            </div>
                        </div> -->


        <table class="basica">
            <thead>
                <tr>
                    <th [ngClass]="{desc:orderBy=='Fecha' && orderDirection=='DESC',asc:orderBy=='Fecha' && orderDirection=='ASC'}"
                        (click)="ordenar('Fecha')">Fecha</th>
                    <th [ngClass]="{desc:orderBy=='Paciente' && orderDirection=='DESC',asc:orderBy=='Paciente' && orderDirection=='ASC'}"
                        (click)="ordenar('Paciente')">Familiar</th>
                    <th [ngClass]="{desc:orderBy=='Doctor' && orderDirection=='DESC',asc:orderBy=='Doctor' && orderDirection=='ASC'}"
                        (click)="ordenar('Doctor')">Doctor</th>
                    <th [ngClass]="{desc:orderBy=='Especialidad' && orderDirection=='DESC',asc:orderBy=='Especialidad' && orderDirection=='ASC'}"
                        (click)="ordenar('Especialidad')">Especialidad</th>
                        <th>Estado</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let i of info_citas" [ngClass]="{cancelada:i.cita.estatus == 'CANCELADA'}">
                    <td>{{i.cita.inicio| date: 'short' }}</td>
                    <td>{{i.paciente.nombre}}</td>
                    <td>{{i.doctor? i.doctor.nombre : ''}}</td>
                    <td>{{i.doctor? i.doctor.especialidad : ''}}</td>
                    <td>{{i.cita.estatus}}</td>
                    <td class="p-0 options">
                       <!-- BOTONES DISABLED -->
                            <button  disabled class="btn btn-light p-1 m-1 border" *ngIf="i.cita.estatus == 'PENDIENTE'">
                            <span >
                                <i class="">
                                    <svg aria-hidden="true" width="30px" height="30px" focusable="false" data-prefix="fas" data-icon="user-check" class="svg-inline--fa fa-user-check fa-w-20" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4zm323-128.4l-27.8-28.1c-4.6-4.7-12.1-4.7-16.8-.1l-104.8 104-45.5-45.8c-4.6-4.7-12.1-4.7-16.8-.1l-28.1 27.9c-4.7 4.6-4.7 12.1-.1 16.8l81.7 82.3c4.6 4.7 12.1 4.7 16.8.1l141.3-140.2c4.6-4.7 4.7-12.2.1-16.8z"></path></svg>
                                </i>
                            </span>
                             </button>

                             <button disabled type="button" class="btn btn-light p-1 m-1 border" *ngIf="i.cita.estatus == 'PENDIENTE'">
                             <span >
                                 <i class="">
                                     <svg aria-hidden="true" width="30px" height="30px" focusable="false" data-prefix="fas" data-icon="window-close" class="svg-inline--fa fa-window-close fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M464 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-83.6 290.5c4.8 4.8 4.8 12.6 0 17.4l-40.5 40.5c-4.8 4.8-12.6 4.8-17.4 0L256 313.3l-66.5 67.1c-4.8 4.8-12.6 4.8-17.4 0l-40.5-40.5c-4.8-4.8-4.8-12.6 0-17.4l67.1-66.5-67.1-66.5c-4.8-4.8-4.8-12.6 0-17.4l40.5-40.5c4.8-4.8 12.6-4.8 17.4 0l66.5 67.1 66.5-67.1c4.8-4.8 12.6-4.8 17.4 0l40.5 40.5c4.8 4.8 4.8 12.6 0 17.4L313.3 256l67.1 66.5z"></path></svg>
                                 </i>
                             </span>
                         </button>
                             <!-- BOTONES DISABLED -->
                        <button  class="btn btn-primary p-1 m-1 border"
                            *ngIf="i.cita.estatus == 'ACTIVA' && i.cita.confirmado_por_paciente=='NO'"
                            (click)="currentInfoCita=i;showConfirmPaciente=true;">
                            <span >
                                <i class="">
                                    <svg aria-hidden="true" width="30px" height="30px" focusable="false" data-prefix="fas" data-icon="user-check" class="svg-inline--fa fa-user-check fa-w-20" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4zm323-128.4l-27.8-28.1c-4.6-4.7-12.1-4.7-16.8-.1l-104.8 104-45.5-45.8c-4.6-4.7-12.1-4.7-16.8-.1l-28.1 27.9c-4.7 4.6-4.7 12.1-.1 16.8l81.7 82.3c4.6 4.7 12.1 4.7 16.8.1l141.3-140.2c4.6-4.7 4.7-12.2.1-16.8z"></path></svg>
                                </i>
                            </span>
                        </button>

                        <button type="button" class="btn btn-primary p-1 m-1 border" *ngIf="i.cita.estatus == 'ACTIVA'"
                            (click)="currentInfoCita=i;showConfirmCancelar=true">
                            <span >
                                <i class="">
                                    <svg aria-hidden="true" width="30x" height="30px" focusable="false" data-prefix="fas" data-icon="window-close" class="svg-inline--fa fa-window-close fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M464 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-83.6 290.5c4.8 4.8 4.8 12.6 0 17.4l-40.5 40.5c-4.8 4.8-12.6 4.8-17.4 0L256 313.3l-66.5 67.1c-4.8 4.8-12.6 4.8-17.4 0l-40.5-40.5c-4.8-4.8-4.8-12.6 0-17.4l67.1-66.5-67.1-66.5c-4.8-4.8-4.8-12.6 0-17.4l40.5-40.5c4.8-4.8 12.6-4.8 17.4 0l66.5 67.1 66.5-67.1c4.8-4.8 12.6-4.8 17.4 0l40.5 40.5c4.8 4.8 4.8 12.6 0 17.4L313.3 256l67.1 66.5z"></path></svg>
                                </i>
                            </span>
                        </button>
                      
                    </td>
                </tr>
            </tbody>
        </table>
        <div>
            <app-paginacion [path]="'/citas'" [pages]="pages" [totalPages]="totalPages" [currentPage]="currentPage">
            </app-paginacion>
        </div>
    </div>
</div>

<app-seleccionar-doctor-cita [id_paciente]="id_paciente" [show]="show" (selected)="onSeleccionarDoctorCita($event)"></app-seleccionar-doctor-cita>

<app-modal [show]="showConfirmPaciente">
    <div class="card p-3" style="width: 18rem;">
        <div class="card-body">
            <h5 class="card-title">Confirmar </h5>
            <p class="card-text">Desea confirmar la asistencia del paciente</p>
            <a class="btn text-light mr-3 btn-secondary" (click)="showConfirmPaciente=false">Cancelar</a>
            <a class="btn text-light ml-3 btn-primary" (click)="confirmarPaciente(currentInfoCita)">Aceptar</a>
        </div>
    </div>
</app-modal>

<app-modal [show]="showConfirmCancelar">
    <div class="card p-3" style="width: 18rem;">
        <div class="card-body">
            <h5 class="card-title">Cancelar Cita</h5>
            <p class="card-text">Desea cancelar la cita</p>
            <a class="btn text-light mr-3 btn-secondary" (click)="showConfirmCancelar=false">Cancelar</a>
            <a class="btn text-light ml-3 btn-danger" (click)="cancelar(currentInfoCita)">Aceptar</a>
        </div>
    </div>
</app-modal>

<app-modal [show]="showConfirmActivar">
    <div class="card p-3" style="width: 18rem;">
        <div class="card-body">
            <h5 class="card-title">Cancelar Cita</h5>
            <p class="card-text">Desea cancelar la cita</p>
            <a class="btn text-light mr-3 btn-secondary" (click)="showConfirmActivar=false">Cancelar</a>
            <a class="btn text-light ml-3 btn-danger" (click)="activar(currentInfoCita)">Aceptar</a>
        </div>
    </div>
</app-modal>