<div class="card p-3">
    <div class="">
        
        <div class="p-0">
			<div class="d-flex justify-content-between flex-wrap">
				<div class="mb-3">
					<h4 >MIS CITAS</h4>
				</div>
				<div class="mb-3">
					
                    <div>
                        <button (click)="showSeleccionarDoctorCita()" type="button" class="btn btn-primary btn-sm">Nueva Cita</button>
                    </div>
				</div>
			</div>
		</div>
        <!--  (change)="changeSearch($event)" ionInput="changeSearch($event)" (change)="segmentChanged($event)"-->

        <!-- <div>
                            <div class="d-flex flex-row">
                                <div class="pr-2">
                                    <label>Estado de cita</label>
                                    <select class="form-control" [(ngModel)]="cita_search.eq.estatus">
                                        <option value="">Todas</option>
                                        <option value="ACTIVA">Activa</option>
                                        <option value="CANCELADA">Canceladas</option>
                                    </select>
                                </div>

                                <div class="pr-2">
                                    <label>
                                        Confirmado:
                                    </label>
                                    <div>

                                        <input type="checkbox" value="SI"
                                            [checked]="cita_search.eq.confirmado_por_doctor=='SI'"
                                            (change)="cita_search.eq.confirmado_por_doctor = cita_search.eq.confirmado_por_doctor=='SI' ? '' : 'SI'">
                                        Por doctor
                                    </div>

                                    <div>
                                        <input type="checkbox" value="SI"
                                            [checked]="cita_search.eq.confirmado_por_paciente=='SI'"
                                            (change)="cita_search.eq.confirmado_por_paciente = cita_search.eq.confirmado_por_paciente=='SI' ? '' : 'SI'">
                                        Por paciente
                                    </div>
                                </div>

                                <div class="pr-2">
                                    <label>Clinica</label>
                                    <select class="form-control" [(ngModel)]="cita_search.eq.id_centro_medico">
                                        <option value="">Todas</option>
                                        <option *ngFor="let centro of centros_medicos" [value]="centro.id">
                                            {{centro.nombre}}</option>
                                    </select>
                                </div>
                                <div class="pr-2">
                                    <label>Fecha Inicio</label> <input class="form-control" type="date"
                                        (change)="dateInicioChange($event.target.value)"
                                        [value]="cita_search.ge.inicio">
                                </div>
                                <div class="pr-2">
                                    <label>Fecha Fin</label><input type="date" class="form-control"
                                        (change)="dateFinChange($event.target.value)" [value]="cita_search.le.inicio">
                                </div>
                                <div class="d-flex align-self-end justify-content-center p-2">
                                    <button type="button" class="btn btn-primary" (click)="buscar()">Buscar</button>
                                </div>
                            </div>
                        </div> -->


        <table class="basica">
            <thead>
                <tr>
                    <th [ngClass]="{desc:orderBy=='Fecha' && orderDirection=='DESC',asc:orderBy=='Fecha' && orderDirection=='ASC'}"
                        (click)="ordenar('Fecha')">Fecha</th>
                    <th [ngClass]="{desc:orderBy=='Paciente' && orderDirection=='DESC',asc:orderBy=='Paciente' && orderDirection=='ASC'}"
                        (click)="ordenar('Paciente')">Familiar</th>
                    <th [ngClass]="{desc:orderBy=='Doctor' && orderDirection=='DESC',asc:orderBy=='Doctor' && orderDirection=='ASC'}"
                        (click)="ordenar('Doctor')">Doctor</th>
                    <th [ngClass]="{desc:orderBy=='Especialidad' && orderDirection=='DESC',asc:orderBy=='Especialidad' && orderDirection=='ASC'}"
                        (click)="ordenar('Especialidad')">Especialidad</th>
                        <th>Estado</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngIf="citas_paciente.length==0 " class="text-center">
                    <td colspan="6">No se encontraron registros</td>
                </tr>
                <tr *ngFor="let i of citas_paciente" [ngClass]="{cancelada:i.cita.estatus == 'CANCELADA'}">
                    <td>{{i.cita.inicio| date: 'short' }}</td>
                    <td>{{i.paciente.nombre}}</td>
                    <td>{{i.doctor? i.doctor.nombre : ''}}</td>
                    <td>{{i.doctor? i.doctor.especialidad : ''}}</td>
                    <td>{{i.cita.estatus}}</td>
                    <td class="p-0 options">
                       <!-- BOTONES DISABLED -->
                            <button  disabled class="btn btn-light p-1 m-1 border" *ngIf="i.cita.estatus == 'PENDIENTE' ">
                            <span >
                                <i class="">
                                    <img src="../../../assets/icon/options/confirmar-paciente.png" height="35px" width="35px"
                                    class="menuIcons icons" />
                                </i>
                            </span>
                             </button>

                             <button disabled type="button" class="btn btn-light p-1 m-1 border" *ngIf="i.cita.estatus == 'PENDIENTE'">
                             <span >
                                <i class="">
                                    <img src="../../../assets/icon/options/cancelar-cita.png" height="35px" width="35px"
                                    class="menuIcons icons" />
                                </i> <i class="">
                                     <svg aria-hidden="true" width="30px" height="30px" focusable="false" data-prefix="fas" data-icon="window-close" class="svg-inline--fa fa-window-close fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M464 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-83.6 290.5c4.8 4.8 4.8 12.6 0 17.4l-40.5 40.5c-4.8 4.8-12.6 4.8-17.4 0L256 313.3l-66.5 67.1c-4.8 4.8-12.6 4.8-17.4 0l-40.5-40.5c-4.8-4.8-4.8-12.6 0-17.4l67.1-66.5-67.1-66.5c-4.8-4.8-4.8-12.6 0-17.4l40.5-40.5c4.8-4.8 12.6-4.8 17.4 0l66.5 67.1 66.5-67.1c4.8-4.8 12.6-4.8 17.4 0l40.5 40.5c4.8 4.8 4.8 12.6 0 17.4L313.3 256l67.1 66.5z"></path></svg>
                                 </i>
                             </span>
                         </button>
                             <!-- FIN BOTONES DISABLED -->
                        <!-- confirmar cita -->
                        <button  class="btn btn-light p-1 m-1 border"
                            *ngIf="i.cita.estatus == 'ACTIVA' && i.cita.confirmado_por_paciente=='NO'"
                            (click)="currentInfoCita=i;showConfirmPaciente=true;"
                            data-toggle="tooltip" title="Confirmar Cita">
                            <span >
                                <i class="">

                                    <img src="../../../assets/icon/options/confirmar-paciente.png" height="35px" width="35px"
                                    class="menuIcons icons" />

                                </i>
                            </span>
                        </button>
                        <!-- confirmado por paciente check -->
                        <button  disabled class="btn btn-light p-1 m-1 border"
                        *ngIf="i.cita.estatus == 'ACTIVA' && i.cita.confirmado_por_paciente=='SI'"
                        data-toggle="tooltip" title="Confirmado por paciente">
                        <span >
                            <i class="">

                                <img src="../../../assets/icon/options/confirmado-paciente.png" height="35px" width="35px"
                                class="menuIcons icons" />

                            </i>
                        </span>
                    </button>
                    <!-- notificacion confirmado por doctor -->
                    <button disabled class="btn btn-light p-1 m-1 border"
                        *ngIf="i.cita.estatus == 'ACTIVA' && i.cita.confirmado_por_doctor=='SI'"
                        data-toggle="tooltip" title="Confirmado por doctor">
                        <span >
                            <i class="">

                                <img src="../../../assets/icon/options/confirmado-doctor.png" height="35px" width="35px"
                                class="menuIcons icons" />

                            </i>
                        </span>
                    </button>
                    <!-- cancelar cita -->
                        <button type="button" class="btn btn-light p-1 m-1 border" *ngIf="i.cita.estatus == 'ACTIVA'"
                            (click)="currentInfoCita=i;showConfirmCancelar=true"
                            data-toggle="tooltip" title="Cancelar Cita">
                            <span >
                                <i class="">

                                    <img src="../../../assets/icon/options/cancelar-cita.png" height="35px" width="35px"
                                    class="menuIcons icons" />
                                </i>
                            </span>
                        </button>
                      
                    </td>
                </tr>
            </tbody>
        </table>
        <div *ngIf="citas_paciente.length!=0">
            <app-paginacion [path]="'/citas-paciente'" [pages]="pages" [totalPages]="totalPages" [currentPage]="currentPage">
            </app-paginacion>
        </div>
    </div>
</div>

<app-seleccionar-doctor-cita [id_paciente]="id_paciente" [show]="show" (selected)="onSeleccionarDoctorCita($event)"></app-seleccionar-doctor-cita>

<app-modal [show]="showConfirmPaciente">
    <div class="modal-content" style="width: 25rem;">
        <div class="modal-header">
            <h5 class="modal-title">Confirmar</h5>
        </div>
        <div class="modal-body pb-0">
            <p class="text-center">Desea confirmar la asistencia del paciente?</p>
        </div>
        <div class="modal-footer">
            <a class="btn text-light  btn-secondary" (click)="showConfirmPaciente=false">Cancelar</a>
            <a class="btn text-light  btn-primary" (click)="confirmarPaciente(currentInfoCita)">Aceptar</a>
        </div>
    </div>
</app-modal>

<app-modal [show]="showConfirmCancelar">
    <div class="modal-content" style="width: 25rem;">
        <div class="modal-header">
            <h5 class="modal-title">Cancelar Cita</h5>
        </div>
        <div class="modal-body pb-0">
            <p class="text-center">Desea cancelar la cita?</p>
        </div>
        <div class="modal-footer">
            <a class="btn text-light  btn-secondary" (click)="showConfirmCancelar=false">Cancelar</a>
            <a class="btn text-light btn-danger" (click)="cancelar(currentInfoCita)">Aceptar</a>
        </div>
    </div>
</app-modal>

<app-modal [show]="showConfirmActivar">
    <div class="modal-content" style="width: 25rem;">
        <div class="modal-header">
            <h5 class="modal-title">Confirmar Cita </h5>
        </div>
        <div class="modal-body">
            <p class="car-text">Desea Confirmar la cita?</p>
        </div>
        <div class="modal-footer">
            <a class="btn text-light btn-secondary" (click)="showConfirmActivar=false">Cancelar</a>
            <a class="btn text-light btn-danger" (click)="activar(currentInfoCita)">Aceptar</a>
        </div>
    </div>
</app-modal>
<!-- 
<div class="modal-content" style="width: 25rem;">
    <div class="modal-header">
        <h5 class="modal-title">Confirmar Doctor</h5>
    </div>
    <div class="modal-body pb-0">
        <p class="text-center">Desea confirmar la asistencia del doctor?</p>
    </div>
    <div class="modal-footer">
        <a class="btn text-light  btn-secondary" (click)="showConfirmDoctor=false">Cancelar</a>
        <a class="btn text-light  btn-primary" (click)="confirmarDoctor(currentInfoCita)">Aceptar</a>
    </div>

</div> -->